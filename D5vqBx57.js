import{u as V}from"./v1BhuTDO.js";import{d as U,S as Y,T as z,k as i,o as L,l as v,m as e,n as p,b as c,p as l,v as r,x as u,r as C,w as F,c as D,e as P,t as M,J as $,K as E,L as R,U as S}from"./assets/index-DEyjB_H_.js";import{b as j,d as q}from"./B025ydnH.js";const J=U({__name:"OrderDetailModal",props:Y({currentId:{}},{visible:{type:Boolean},visibleModifiers:{}}),emits:["update:visible"],setup(h){const I=h,n=z(h,"visible"),s=i({buy_ip:"",buy_num:0,content:"",gd_no:"",order_no:"",pay_price:0,pay_price_label:"",payment_channel:null,price:0,price_label:"",status:0,title:"",trade_no:"",type:0,type_label:""}),m=i(!1);function g(){j(I.currentId).then(b=>{s.value=b}).finally(()=>{m.value=!1})}return L(()=>{g()}),(b,d)=>{const o=p("a-form-item"),k=p("a-form"),x=p("a-spin"),w=p("a-modal");return c(),v(w,{open:n.value,"onUpdate:open":d[0]||(d[0]=f=>n.value=f),title:"订单详情"},{footer:e(()=>[]),default:e(()=>[l(x,{spinning:m.value},{default:e(()=>[l(k,{"label-col":{span:5},"wrapper-col":{span:16}},{default:e(()=>[l(o),l(o,{label:"订单编号",name:"source"},{default:e(()=>[r(u(s.value.order_no),1)]),_:1}),l(o,{label:"订单标题",name:"source"},{default:e(()=>[r(u(s.value.title),1)]),_:1}),l(o,{label:"订单类型",name:"source"},{default:e(()=>[r(u(s.value.type_label),1)]),_:1}),l(o,{label:"付款渠道",name:"source"},{default:e(()=>[r(u(s.value.payment_channel||"无"),1)]),_:1}),l(o,{label:"订单状态",name:"source"},{default:e(()=>[r(u(s.value.status),1)]),_:1}),l(o,{label:"第三方事务号",name:"source"},{default:e(()=>[r(u(s.value.trade_no||"无"),1)]),_:1}),l(o,{label:"购买数量",name:"source"},{default:e(()=>[r(u(s.value.buy_num),1)]),_:1}),l(o,{label:"下单IP",name:"source"},{default:e(()=>[r(u(s.value.buy_ip),1)]),_:1}),l(o,{label:"订单金额",name:"source"},{default:e(()=>[r(u(s.value.price_label),1)]),_:1}),l(o,{label:"订单支付金额",name:"source"},{default:e(()=>[r(u(s.value.pay_price_label),1)]),_:1})]),_:1})]),_:1},8,["spinning"])]),_:1},8,["open"])}}}),K={class:"w-[1200px] m-auto"},W={class:"flex items-start justify-between mb-4"},Z=U({__name:"index",setup(h){const I=[{title:"订单编号",dataIndex:"order_no"},{title:"订单类型",dataIndex:"type_label"},{title:"商品标题",dataIndex:"title"},{title:"购买数量",dataIndex:"buy_num"},{title:"订单状态",dataIndex:"status_label"},{title:"订单金额",dataIndex:"price_label"},{title:"订单支付金额",dataIndex:"pay_price_label"},{title:"付款渠道",dataIndex:"payment_channel"},{title:"第三方事务号",dataIndex:"trade_no"},{title:"操作",dataIndex:"operation",fixed:"right"}],n=C({end_time:"",gd_no:"",order_no:"",start_time:"",page:1,limit:10}),s=i(!1),m=i(!1),g=i([]),b=i([]),d=C({current:n.page,pageSize:n.limit,hideOnSinglePage:!0,pageSizeOptions:["10","15","20"],showTotal(a){return`共 ${a} 条`},showSizeChanger:!0,onChange(a,_){m.value=!0,n.page=a,n.limit=_,d.current=a,d.pageSize=_},total:0}),{run:o}=V(async()=>q($(n)).then(a=>{g.value=a.list,d.total=a.total,b.value=a.filter,k(),m.value=!1}),{debounceWait:1e3,manual:!0});function k(){b.value.forEach(a=>{a.options&&(w.value[a.name]=a.options.filter(_=>_.value!==0))})}F(n,()=>{m.value===!1&&(n.page=1,d.current=1),o()});const x=i(""),w=i({}),f=i(!1);function B(a){x.value=(a==null?void 0:a.order_no)||"",f.value=!0}return L(o),(a,_)=>{const O=p("a-form-item"),H=p("a-form"),N=p("a-button"),T=p("a-table");return c(),D("div",K,[P("div",W,[l(H,{class:"filter",layout:"inline"},{default:e(()=>[(c(!0),D(E,null,R(b.value,t=>(c(),v(O,{key:t.name,label:t.label},{default:e(()=>[t.type==="datetime"?(c(),v(S("a-date-picker"),{key:0,value:n[t.name],"onUpdate:value":y=>n[t.name]=y,placeholder:t.label,"show-time":{format:"HH:mm"},"allow-clear":"",class:"w-[180px!important] mr-2 mb-2",valueFormat:"YYYY-MM-DD HH:mm:ss"},null,40,["value","onUpdate:value","placeholder"])):(c(),v(S("a-"+t.type),{key:1,value:n[t.name],"onUpdate:value":y=>n[t.name]=y,options:t.options,placeholder:t.label,"allow-clear":"",class:"w-[180px!important] mr-2 mb-2"},null,40,["value","onUpdate:value","options","placeholder"]))]),_:2},1032,["label"]))),128))]),_:1})]),l(T,{columns:I,dataSource:g.value,loading:s.value,pagination:d,"row-key":t=>t.gd_no,bordered:"",class:"w-full mb-4"},{bodyCell:e(({column:t,record:y})=>[t.dataIndex==="operation"?(c(),v(N,{key:0,class:"mr-1",type:"primary",onClick:A=>B(y)},{default:e(()=>[r("详情 ")]),_:2},1032,["onClick"])):M("",!0)]),_:1},8,["dataSource","loading","pagination","row-key"]),f.value?(c(),v(J,{key:0,visible:f.value,"onUpdate:visible":_[0]||(_[0]=t=>f.value=t),currentId:x.value},null,8,["visible","currentId"])):M("",!0)])}}});export{Z as default};
